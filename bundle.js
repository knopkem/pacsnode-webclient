!function(n){var r={};function e(t){if(r[t])return r[t].exports;var i=r[t]={i:t,l:!1,exports:{}};return n[t].call(i.exports,i,i.exports,e),i.l=!0,i.exports}e.m=n,e.c=r,e.d=function(n,r,t){e.o(n,r)||Object.defineProperty(n,r,{enumerable:!0,get:t})},e.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,r){if(1&r&&(n=e(n)),8&r)return n;if(4&r&&"object"==typeof n&&n&&n.__esModule)return n;var t=Object.create(null);if(e.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:n}),2&r&&"string"!=typeof n)for(var i in n)e.d(t,i,function(r){return n[r]}.bind(null,i));return t},e.n=function(n){var r=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(r,"a",r),r},e.o=function(n,r){return Object.prototype.hasOwnProperty.call(n,r)},e.p="/",e(e.s=0)}([function(n,r,e){e(1),n.exports=e(4)},function(n,r,e){e(2)(e(3))},function(n,r){n.exports=function(n){function r(n){"undefined"!=typeof console&&(console.error||console.log)("[Script Loader]",n)}try{"undefined"!=typeof execScript&&"undefined"!=typeof attachEvent&&"undefined"==typeof addEventListener?execScript(n):"undefined"!=typeof eval?eval.call(null,n):r("EvalError: No eval function available")}catch(n){r(n)}}},function(n,r){n.exports=' // import DicomViewer, Hammer, $, log, Preloader, CacheManager\r\n // todo: remove jquery and hammer dependencies\r\n\r\n/**\r\n * This is the main entry point for integration the viewer into an application\r\n * The controller manages multiple specialized viewers and manages slice stacks\r\n * Viewers only handle single images, while the task of the controller is to operate on a stack of objects\r\n * @constructor\r\n */\r\nclass ViewMaster {\r\n    constructor(viewer_id, overlay_id) {\r\n        this.viewer_id = viewer_id;\r\n        this.viewerCanvas = window.document.getElementById(viewer_id);\r\n        this.overlayCanvas = window.document.getElementById(overlay_id);\r\n        this.singleViewer = new pnw.DicomViewer(viewer_id);\r\n        this.viewer = this.singleViewer;\r\n        this.cache = new pnw.CacheManager();\r\n        this.slider = new pnw.Slider(overlay_id);\r\n\r\n        // open cache database\r\n        this.cache.init();\r\n\r\n        // helper\r\n        this.interactionMode = 0;\r\n        this.currentSliderPos = 0;\r\n        this.sopInstances = {};\r\n        this.sliderPosTemp = 0;\r\n        this.lastSOP = \'\';\r\n        this.lastPosY = 0;\r\n        this.preloaderTimeout = 0;\r\n\r\n        /*\r\n            var that = this;\r\n            this.preloader = new pnw.Preloader(this.cache, function (percentage, remaining) {\r\n                that.drawPreloadingLabel(percentage, remaining);\r\n            });\r\n\r\n            // prepare handlers\r\n            this.prepare();\r\n\r\n            window.pubsub.sub("sliceLoadStart", function (e) {\r\n                if (that.preloader.isRunning()) {\r\n                    that.preloader.stop();\r\n                }\r\n            });\r\n\r\n            window.pubsub.sub("sliceLoadStop", function (e) {\r\n                log.debug(\'slice loading finished\', e);\r\n                if (!that.preloader.isRunning()) {\r\n                    log.debug("slice loading finished, restarting preloader");\r\n                    if (that.preloaderTimeout !== 0) {\r\n                        window.clearTimeout(that.preloaderTimeout);\r\n                        that.preloaderTimeout = 0;\r\n                    }\r\n                    that.preloaderTimeout = setTimeout(function () {\r\n                        that.preloader.start(e);\r\n                    }, 500);\r\n                }\r\n            });\r\n        */\r\n    },\r\n    reset() {\r\n        this.interactionMode = 0;\r\n        this.currentSliderPos = 0;\r\n        this.sopInstances = {};\r\n        this.sliderPosTemp = 0;\r\n        this.lastPosY = 0;\r\n        this.sliderTimeout = 0;\r\n        this.preloaderTimeout = 0;\r\n    },\r\n    prepare() {\r\n    /*\r\n    var that = this,\r\n        hammertime = new Hammer(this.overlayCanvas, {\r\n            drag_min_distance: 1,\r\n            drag_horizontal: true,\r\n            drag_vertical: true,\r\n            transform: true,\r\n            hold: false,\r\n            prevent_default: true,\r\n            drag_max_touches: 2\r\n        });\r\n\r\n    hammertime.on("dragstart", function (ev) {\r\n\r\n        that.sliderPosTemp = that.currentSliderPos;\r\n        that.lastPosY = ev.gesture.center.pageY;\r\n\r\n        that.viewer.onDragStart(ev);\r\n    });\r\n\r\n    hammertime.on("drag", function (ev) {\r\n\r\n        // change of slice only when draging with 1 finger\r\n        if ((ev.gesture.touches.length === 1) && (that.viewer.isHandlingEvents() === false) && (that.viewer.interactionMode === 0)) {\r\n\r\n            var sliceCount = that.sopInstances.length,\r\n                delta = 0,\r\n                diffY = 0,\r\n                deltaSliderPos = 0,\r\n                currentSOP = "",\r\n                //curPosX = ev.gesture.center.pageX,\r\n                curPosY = ev.gesture.center.pageY;\r\n\r\n            // compute difference\r\n            diffY = (that.lastPosY - curPosY) * (-1);\r\n\r\n            // handle stacking here\r\n            if (that.interactionMode === 0) {\r\n                // not the best solution but so far helps with series that have only a few slices\r\n                if (sliceCount < 10) {\r\n                    sliceCount = 10;\r\n                }\r\n                // slicing\r\n                delta = parseInt(sliceCount / that.viewerCanvas.height * diffY, 10);\r\n                if (delta !== 0) {\r\n                    deltaSliderPos = parseInt(that.sliderPosTemp + delta, 10);\r\n                    deltaSliderPos = pnw.MathHelper.clamp(deltaSliderPos, 0, that.sopInstances.length - 1);\r\n                    currentSOP = that.getCurrentSOP(deltaSliderPos);\r\n                }\r\n                if ((that.lastSOP !== currentSOP) && (currentSOP !== \'\')) {\r\n                    // now load a new image\r\n                    that.viewer.loadDicom(currentSOP);\r\n                    that.drawSlider(deltaSliderPos);\r\n                    that.lastSOP = currentSOP;\r\n                }\r\n                return;\r\n            }\r\n                }\r\n\r\n                // forward to viewer\r\n                that.viewer.onDrag(ev);\r\n            });\r\n\r\n            hammertime.on("dragend", function (ev) {\r\n                that.viewer.onDragEnd(ev);\r\n            });\r\n\r\n            // mouseweel plugin\r\n            $(this.overlayCanvas).bind("mousewheel.TileViewerer", function (e, delta) {\r\n                that.viewer.onMouseWheelMove(e, delta);\r\n            });\r\n\r\n            */\r\n        },\r\n    onResize(width, height) {\r\n        this.viewer.onCanvasResize(width, height);\r\n        this.overlayCanvas.width = width;\r\n        this.overlayCanvas.height = height;\r\n\r\n        this.slider.draw();\r\n    },\r\n    init(base, studyUid, seriesUid) {\r\n\r\n        var that = this,\r\n            pData = null,\r\n            currentSOP = "";\r\n\r\n        if (studyUid === null || studyUid === \'\' || seriesUid === null || seriesUid === \'\') {\r\n            log.warning(\'init failed, invalid input\' + studyUid + seriesUid);\r\n            return;\r\n        }\r\n\r\n        // reset all variables\r\n        this.reset();\r\n\r\n         // TODO replace with fetch api\r\n        /*\r\n        $.ajax({\r\n                url: "/queryStudyAndSeriesInfo",\r\n                dataType: "json",\r\n                data: {\r\n                    stdUID: studyUid,\r\n                    serUID: seriesUid\r\n                }\r\n            })\r\n            .then(function (response) {\r\n                $.each(response, function (i, val) {\r\n                    pData = val;\r\n                });\r\n                that.sopInstances = pData.LocalInstances.split("#");\r\n                that.currentSliderPos = parseInt(that.sopInstances.length / 2, 10);\r\n                that.getViewer(pData.DCM_Modality);\r\n                that.viewer.init(base, pData, that.cache);\r\n                that.preloader.init(base, that.sopInstances);\r\n                currentSOP = that.getCurrentSOP(that.currentSliderPos);\r\n                // load the first image\r\n                that.viewer.setInteractionMode(that.interactionMode);\r\n                that.viewer.loadDicom(currentSOP);\r\n                if (that.sopInstances.length > 1) {\r\n                    that.drawSlider(that.currentSliderPos);\r\n                }\r\n                // make sure to resize\r\n                that.viewer.onCanvasResize(that.viewerCanvas.width, that.viewerCanvas.height);\r\n            });\r\n          */\r\n    },\r\n    drawSlider(sliderPos) {\r\n        this.slider.setSliderPosition(0, this.sopInstances.length - 1, sliderPos);\r\n    },\r\n    drawPreloadingLabel(percentage, remaining) {\r\n        this.slider.setLabel(percentage, remaining);\r\n    },\r\n    setInteractionMode(mode) {\r\n        this.interactionMode = mode;\r\n        this.viewer.setInteractionMode(mode);\r\n    },\r\n    createTool(toolId) {\r\n        \r\n        this.viewer.createTool(toolId);\r\n    },\r\n    getCurrentSOP(position) {\r\n        \r\n        var parsedPos = pnw.MathHelper.clamp(parseInt(position, 10), 0, this.sopInstances.length - 1);\r\n        this.currentSliderPos = parsedPos;\r\n        return this.sopInstances[parsedPos];\r\n    },\r\n    getViewer(modality) {\r\n        \r\n        this.viewer = null;\r\n        this.viewer = new pnw.DicomViewer(this.viewer_id);\r\n        this.interactionMode = 0; // force stack mode\r\n        return this.viewer;\r\n    },\r\n    stringContains(input, substring) {\r\n        return (input.search(substring) !== -1) ? true : false;\r\n    }\r\n}\r\n'},function(n,r,e){var t=e(5),i=e(6);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[n.i,i,""]]);var a={insert:"head",singleton:!1};t(i,a);n.exports=i.locals||{}},function(n,r,e){"use strict";var t,i=function(){return void 0===t&&(t=Boolean(window&&document&&document.all&&!window.atob)),t},a=function(){var n={};return function(r){if(void 0===n[r]){var e=document.querySelector(r);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(n){e=null}n[r]=e}return n[r]}}(),o=[];function s(n){for(var r=-1,e=0;e<o.length;e++)if(o[e].identifier===n){r=e;break}return r}function l(n,r){for(var e={},t=[],i=0;i<n.length;i++){var a=n[i],l=r.base?a[0]+r.base:a[0],d=e[l]||0,c="".concat(l," ").concat(d);e[l]=d+1;var u=s(c),p={css:a[1],media:a[2],sourceMap:a[3]};-1!==u?(o[u].references++,o[u].updater(p)):o.push({identifier:c,updater:g(p,r),references:1}),t.push(c)}return t}function d(n){var r=document.createElement("style"),t=n.attributes||{};if(void 0===t.nonce){var i=e.nc;i&&(t.nonce=i)}if(Object.keys(t).forEach((function(n){r.setAttribute(n,t[n])})),"function"==typeof n.insert)n.insert(r);else{var o=a(n.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(r)}return r}var c,u=(c=[],function(n,r){return c[n]=r,c.filter(Boolean).join("\n")});function p(n,r,e,t){var i=e?"":t.media?"@media ".concat(t.media," {").concat(t.css,"}"):t.css;if(n.styleSheet)n.styleSheet.cssText=u(r,i);else{var a=document.createTextNode(i),o=n.childNodes;o[r]&&n.removeChild(o[r]),o.length?n.insertBefore(a,o[r]):n.appendChild(a)}}function h(n,r,e){var t=e.css,i=e.media,a=e.sourceMap;if(i?n.setAttribute("media",i):n.removeAttribute("media"),a&&btoa&&(t+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),n.styleSheet)n.styleSheet.cssText=t;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(t))}}var A=null,f=0;function g(n,r){var e,t,i;if(r.singleton){var a=f++;e=A||(A=d(r)),t=p.bind(null,e,a,!1),i=p.bind(null,e,a,!0)}else e=d(r),t=h.bind(null,e,r),i=function(){!function(n){if(null===n.parentNode)return!1;n.parentNode.removeChild(n)}(e)};return t(n),function(r){if(r){if(r.css===n.css&&r.media===n.media&&r.sourceMap===n.sourceMap)return;t(n=r)}else i()}}n.exports=function(n,r){(r=r||{}).singleton||"boolean"==typeof r.singleton||(r.singleton=i());var e=l(n=n||[],r);return function(n){if(n=n||[],"[object Array]"===Object.prototype.toString.call(n)){for(var t=0;t<e.length;t++){var i=s(e[t]);o[i].references--}for(var a=l(n,r),d=0;d<e.length;d++){var c=s(e[d]);0===o[c].references&&(o[c].updater(),o.splice(c,1))}e=a}}}},function(n,r,e){(r=e(7)(!0)).push([n.i,"\r\nhtml{\r\n  overflow: hidden;\r\n}\r\n\r\n._1Mpsl3F78AqGHABJ0qBx1F { \r\n    background:#2b2e31;\r\n}\r\n\r\n._3OngXkk6IruTAB7FM6w4kw {\r\n    padding: 0px;\r\n    margin: 0px;\r\n}\r\n \r\n._1_73G2jIwO76eMgXtIGtso {\r\n    padding: 0px;\r\n    margin: 0px;\r\n}\r\n\r\n#_30EDVB7ash8zO8IY_pcAOz {\r\n    position: relative;\r\n    left: 2%;\r\n    width: 96%\r\n}\r\n \r\n._2T-lwqGHoF7VQDXaCwp4kC {\r\n    margin: 0px;\r\n    padding: 0px;\r\n}\r\n\r\n._2hz1dFApAwJ7dhUH0qoPg1 {\r\n    margin: 0px;\r\n}\r\n \r\n.xFsXNZ5p1eluVjMbXdfOA, .xFsXNZ5p1eluVjMbXdfOA div._39qO6gtur9LQMX8YS_N5Cb {   \r\n    padding: 0px;\r\n    left: 2%;\r\n    width: 98%;\r\n}\r\n\r\n._1CCEQeib0yQKayHFSR0Ema, ._1CCEQeib0yQKayHFSR0Ema div._39qO6gtur9LQMX8YS_N5Cb {\r\n    left: 2%;\r\n    width: 98%;\r\n}\r\n\r\n._3VlfTUoiItE_XtaDwkYzwB {\r\n    padding: 0;\r\n    margin: 0;\r\n    position: absolute;\r\n    z-index: 0;\r\n}\r\n\r\n._11eHGGz16V6ePofc6Mjvuu {\r\n    padding: 0;\r\n    margin: 0;\r\n    position: absolute;\r\n    z-index: 1;\r\n}\r\n/*\r\n.pn-div {\r\n    padding: 0;\r\n    margin: 0;\r\n    position: relative;\r\n    overflow: hidden;\r\n}\r\n*/\r\n._3hsEBw_57358gHSQHa3lYz {\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 5px;\r\n    z-index: 2;\r\n}\r\n\r\n.wFBCGYL_uwi2uNC_p1Ebc {\r\n    position: absolute;\r\n    top: 50%;\r\n    right: 5px;\r\n    z-index: 2;\r\n}\r\n\r\n._3VjLHYJkwkbCR6Qs2cHlX1 {\r\n    position: absolute;\r\n    top: 5px;\r\n    right: 50%;\r\n    z-index: 2;\r\n}\r\n\r\n._2x_RxzW4ZEjGGjdFCj8-2j {\r\n    min-height: 80px; \r\n    min-width: 80px;\r\n}\r\n\r\n","",{version:3,sources:["ui.css"],names:[],mappings:";AACA;EACE,gBAAgB;AAClB;;AAEA;IACI,kBAAkB;AACtB;;AAEA;IACI,YAAY;IACZ,WAAW;AACf;;AAEA;IACI,YAAY;IACZ,WAAW;AACf;;AAEA;IACI,kBAAkB;IAClB,QAAQ;IACR;AACJ;;AAEA;IACI,WAAW;IACX,YAAY;AAChB;;AAEA;IACI,WAAW;AACf;;AAEA;IACI,YAAY;IACZ,QAAQ;IACR,UAAU;AACd;;AAEA;IACI,QAAQ;IACR,UAAU;AACd;;AAEA;IACI,UAAU;IACV,SAAS;IACT,kBAAkB;IAClB,UAAU;AACd;;AAEA;IACI,UAAU;IACV,SAAS;IACT,kBAAkB;IAClB,UAAU;AACd;AACA;;;;;;;CAOC;AACD;IACI,kBAAkB;IAClB,QAAQ;IACR,SAAS;IACT,UAAU;AACd;;AAEA;IACI,kBAAkB;IAClB,QAAQ;IACR,UAAU;IACV,UAAU;AACd;;AAEA;IACI,kBAAkB;IAClB,QAAQ;IACR,UAAU;IACV,UAAU;AACd;;AAEA;IACI,gBAAgB;IAChB,eAAe;AACnB",file:"ui.css",sourcesContent:["\r\nhtml{\r\n  overflow: hidden;\r\n}\r\n\r\n.ui-page { \r\n    background:#2b2e31;\r\n}\r\n\r\n.ui-header {\r\n    padding: 0px;\r\n    margin: 0px;\r\n}\r\n \r\n.ui-content {\r\n    padding: 0px;\r\n    margin: 0px;\r\n}\r\n\r\n#header-wrapper {\r\n    position: relative;\r\n    left: 2%;\r\n    width: 96%\r\n}\r\n \r\n.pn-study-listview-dynamic {\r\n    margin: 0px;\r\n    padding: 0px;\r\n}\r\n\r\n.pn-series-listview {\r\n    margin: 0px;\r\n}\r\n \r\n.study-wrapper, .study-wrapper div.iscroll-scroller {   \r\n    padding: 0px;\r\n    left: 2%;\r\n    width: 98%;\r\n}\r\n\r\n.series-wrapper, .series-wrapper div.iscroll-scroller {\r\n    left: 2%;\r\n    width: 98%;\r\n}\r\n\r\n.pn-viewer-canvas {\r\n    padding: 0;\r\n    margin: 0;\r\n    position: absolute;\r\n    z-index: 0;\r\n}\r\n\r\n.pn-overlay-canvas {\r\n    padding: 0;\r\n    margin: 0;\r\n    position: absolute;\r\n    z-index: 1;\r\n}\r\n/*\r\n.pn-div {\r\n    padding: 0;\r\n    margin: 0;\r\n    position: relative;\r\n    overflow: hidden;\r\n}\r\n*/\r\n.pn-btn-left {\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 5px;\r\n    z-index: 2;\r\n}\r\n\r\n.pn-btn-right {\r\n    position: absolute;\r\n    top: 50%;\r\n    right: 5px;\r\n    z-index: 2;\r\n}\r\n\r\n.pn-btn-center {\r\n    position: absolute;\r\n    top: 5px;\r\n    right: 50%;\r\n    z-index: 2;\r\n}\r\n\r\n.ui-li-thumb {\r\n    min-height: 80px; \r\n    min-width: 80px;\r\n}\r\n\r\n"]}]),r.locals={"ui-page":"_1Mpsl3F78AqGHABJ0qBx1F","ui-header":"_3OngXkk6IruTAB7FM6w4kw","ui-content":"_1_73G2jIwO76eMgXtIGtso","header-wrapper":"_30EDVB7ash8zO8IY_pcAOz","pn-study-listview-dynamic":"_2T-lwqGHoF7VQDXaCwp4kC","pn-series-listview":"_2hz1dFApAwJ7dhUH0qoPg1","study-wrapper":"xFsXNZ5p1eluVjMbXdfOA","iscroll-scroller":"_39qO6gtur9LQMX8YS_N5Cb","series-wrapper":"_1CCEQeib0yQKayHFSR0Ema","pn-viewer-canvas":"_3VlfTUoiItE_XtaDwkYzwB","pn-overlay-canvas":"_11eHGGz16V6ePofc6Mjvuu","pn-btn-left":"_3hsEBw_57358gHSQHa3lYz","pn-btn-right":"wFBCGYL_uwi2uNC_p1Ebc","pn-btn-center":"_3VjLHYJkwkbCR6Qs2cHlX1","ui-li-thumb":"_2x_RxzW4ZEjGGjdFCj8-2j"},n.exports=r},function(n,r,e){"use strict";n.exports=function(n){var r=[];return r.toString=function(){return this.map((function(r){var e=function(n,r){var e=n[1]||"",t=n[3];if(!t)return e;if(r&&"function"==typeof btoa){var i=(o=t,s=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(l," */")),a=t.sources.map((function(n){return"/*# sourceURL=".concat(t.sourceRoot||"").concat(n," */")}));return[e].concat(a).concat([i]).join("\n")}var o,s,l;return[e].join("\n")}(r,n);return r[2]?"@media ".concat(r[2]," {").concat(e,"}"):e})).join("")},r.i=function(n,e,t){"string"==typeof n&&(n=[[null,n,""]]);var i={};if(t)for(var a=0;a<this.length;a++){var o=this[a][0];null!=o&&(i[o]=!0)}for(var s=0;s<n.length;s++){var l=[].concat(n[s]);t&&i[l[0]]||(e&&(l[2]?l[2]="".concat(e," and ").concat(l[2]):l[2]=e),r.push(l))}},r}}]);